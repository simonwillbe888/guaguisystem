(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f4af7d1e"],{"28a5":function(e,t,a){"use strict";var i=a("aae3"),n=a("cb7c"),r=a("ebd6"),l=a("0390"),o=a("9def"),s=a("5f1b"),c=a("520a"),u=a("79e5"),d=Math.min,p=[].push,m="split",f="length",g="lastIndex",h=4294967295,v=!u((function(){RegExp(h,"y")}));a("214f")("split",2,(function(e,t,a,u){var b;return b="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[f]||2!="ab"[m](/(?:ab)*/)[f]||4!="."[m](/(.?)(.?)/)[f]||"."[m](/()()/)[f]>1||""[m](/.?/)[f]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!i(e))return a.call(n,e,t);var r,l,o,s=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,m=void 0===t?h:t>>>0,v=new RegExp(e.source,u+"g");while(r=c.call(v,n)){if(l=v[g],l>d&&(s.push(n.slice(d,r.index)),r[f]>1&&r.index<n[f]&&p.apply(s,r.slice(1)),o=r[0][f],d=l,s[f]>=m))break;v[g]===r.index&&v[g]++}return d===n[f]?!o&&v.test("")||s.push(""):s.push(n.slice(d)),s[f]>m?s.slice(0,m):s}:"0"[m](void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:a.call(this,e,t)}:a,[function(a,i){var n=e(this),r=void 0==a?void 0:a[t];return void 0!==r?r.call(a,n,i):b.call(String(n),a,i)},function(e,t){var i=u(b,e,this,t,b!==a);if(i.done)return i.value;var c=n(e),p=String(this),m=r(c,RegExp),f=c.unicode,g=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(v?"y":"g"),y=new m(v?c:"^(?:"+c.source+")",g),_=void 0===t?h:t>>>0;if(0===_)return[];if(0===p.length)return null===s(y,p)?[p]:[];var T=0,x=0,w=[];while(x<p.length){y.lastIndex=v?x:0;var k,D=s(y,v?p:p.slice(x));if(null===D||(k=d(o(y.lastIndex+(v?0:x)),p.length))===T)x=l(p,x,f);else{if(w.push(p.slice(T,x)),w.length===_)return w;for(var S=1;S<=D.length-1;S++)if(w.push(D[S]),w.length===_)return w;x=T=k}}return w.push(p.slice(T)),w}]}))},"333d":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},n=[];a("c5f6");Math.easeInOutQuad=function(e,t,a,i){return e/=i/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function l(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,a){var i=o(),n=e-i,s=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=s;var o=Math.easeInOutQuad(c,i,n,t);l(o),c<t?r(e):a&&"function"===typeof a&&a()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&s(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&s(0,800)}}},u=c,d=(a("9567"),a("2877")),p=Object(d["a"])(u,i,n,!1,null,"2fa86365",null);t["a"]=p.exports},3816:function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"g",(function(){return r})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"j",(function(){return m}));var i=a("b775");function n(e){return Object(i["a"])({url:"/api/PatrolFile/getPatrolFileList",method:"post",data:e})}function r(e){return Object(i["a"])({url:"/api/PatrolRecord/getPatrolRecordList",method:"post",data:e})}function l(e){return Object(i["a"])({url:"/api/AlarmRecord/getCurrentAlarmRecordList",method:"post",data:e})}function o(){return Object(i["a"])({url:"/api/AlarmRecord/getAlarmStateList",method:"get"})}function s(e){return Object(i["a"])({url:"/api/AlarmRecord/getAlarmRecordList",method:"post",data:e})}function c(e){return Object(i["a"])({url:"/api/AlarmRecord/dealAlarm",method:"post",data:e})}function u(e){return Object(i["a"])({url:"/api/AlarmRecord/getAlarmDealLog",method:"post",params:e})}function d(){return Object(i["a"])({url:"/api/PatrolTask/GetRealPatrolTaskList",method:"get"})}function p(e){return Object(i["a"])({url:"/api/PatrolTask/CancelPatrolTask",method:"post",data:e})}function m(){return Object(i["a"])({url:"/api/PatrolRecord/getPatrolActionTypeList",method:"get"})}},3964:function(e,t,a){},9567:function(e,t,a){"use strict";a("c54f")},a9d2:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"1%"}},[a("div",{staticClass:"equip-header content-header"},[a("div",{staticClass:"robot-setting-inquire"},[a("span",[e._v(e._s(e.$t("comment_vary.default_time_label")))]),e._v(" "),a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:e.$t("comment_vary.start_time_label")},model:{value:e.startVal,callback:function(t){e.startVal=t},expression:"startVal"}}),e._v(" "),a("span",[e._v("--")]),e._v(" "),a("el-date-picker",{staticStyle:{"margin-right":"20px"},attrs:{type:"datetime",placeholder:e.$t("comment_vary.end_time_label"),"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.endVal,callback:function(t){e.endVal=t},expression:"endVal"}}),e._v(" "),a("div",{staticClass:"filter-sty"},[a("span",[e._v(e._s(e.$t("inspect_record.filter_condition_label")))]),e._v(" "),a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:""},model:{value:e.condition,callback:function(t){e.condition=t},expression:"condition"}},e._l(e.filterOption,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-button",{staticClass:"commen-button",attrs:{size:"mini"},nativeOn:{click:function(t){return e.init(t)}}},[e._v(e._s(e.$t("comment_vary.query_label")))])],1),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"right"}},[e.exportVisible?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.downDialog}},[e._v(e._s(e.$t("inspect_record.export_label")))]):e._e()],1)]),e._v(" "),a("div",{staticClass:"equip-body content-body"},[a("el-table",{staticClass:"equip-data",attrs:{data:e.alarmInfoArr,"header-row-class-name":"header-row-class","row-class-name":"row-class",fit:"","highlight-current-row":"",size:"small"}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"planName",label:"计划名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.planName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"carrierName",label:"小车名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.carrierName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operateType",label:"操作类型",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.taskType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isAlarm",label:"是否有告警",align:"center",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.isAlarm>0?"是":"否"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.startTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.endTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"details",label:"详细信息",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-document",size:"mini",disabled:7===i.operateType},on:{click:function(t){return e.showDetail(i)}}},[e._v(e._s(e.$t("plan_config.inqireDetail_label")))])]}}])})],1),e._v(" "),a("div",[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.page,limit:e.limit},on:{"update:page":function(t){e.page=t},"update:limit":function(t){e.limit=t},pagination:e.setPage}})],1)],1),e._v(" "),a("el-dialog",{staticClass:"export-sty",attrs:{title:e.$t("inspect_record.export_alarm_data"),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-position":"left","label-width":"100px"}},[a("el-form-item",{staticStyle:{"margin-left":"80px"},attrs:{label:e.$t("inspect_record.file_name")}},[a("el-input",{attrs:{placeholder:"请输入文件名","prefix-icon":"el-icon-document"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-left":"80px"},attrs:{label:e.$t("inspect_record.text_type")}},[a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:""},model:{value:e.textType,callback:function(t){e.textType=t},expression:"textType"}},e._l(e.options,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"common-form-footer"},[a("el-button",{attrs:{type:"primary",loading:e.downloadLoading},on:{click:function(t){return e.handleDownload()}}},[e._v(e._s(e.$t("inspect_record.will_export")))]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.cancel()}}},[e._v(e._s(e.$t("inspect_record.cancel_label")))])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"detail-dialog",attrs:{title:e.$t("inspect_record.equipAlarm_detail_label"),visible:e.dialogDetailFlag},on:{"update:visible":function(t){e.dialogDetailFlag=t}}},[a("div",{staticStyle:{padding:"20px"}},[a("swiper",{ref:"mySwiper"},e._l(e.detailes,(function(e){return a("swiper-slide",{key:e.url,staticClass:"info-item"},[2===e.type?[a("video",{staticClass:"centeredVideo",staticStyle:{height:"100%",width:"100%"},attrs:{id:"detailVideo",controls:"",autoplay:""}},[a("source",{attrs:{src:e.url,type:"video/mp4"}})])]:[a("el-image",{staticStyle:{height:"100%",width:"100%","object-fit":"contain"},attrs:{src:e.url,lazy:""}})]],2)})),1),e._v(" "),e._e()],1)])],1)},n=[],r=a("c7eb"),l=(a("ac6a"),a("96cf"),a("1da1")),o=(a("7514"),a("5530")),s=(a("28a5"),a("a481"),a("6b54"),a("53ca"));function c(e,t){if(0===arguments.length)return null;var a,i=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(s["a"])(e)?a=e:("string"===typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"===typeof e&&10===e.toString().length&&(e*=1e3),a=new Date(e));var n={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()},r=i.replace(/{(y|m|d|h|i|s|a)+}/g,(function(e,t){var a=n[t];return"a"===t?["日","一","二","三","四","五","六"][a]:(e.length>0&&a<10&&(a="0"+a),a||0)}));return r}var u=a("3816"),d=a("333d"),p=a("2f62"),m={components:{Pagination:d["a"]},computed:Object(o["a"])({},Object(p["b"])(["webSocketUrl"])),data:function(){return{startVal:"",endVal:"",exportVisible:!1,filterOption:[{value:0,label:"全部"},{value:1,label:"告警"},{value:2,label:"正常"}],condition:0,alarmInfoArr:[],dialogFormVisible:!1,dialogDetailFlag:!1,formLabelWidth:"110px",fileName:"",textType:"xlsx",downloadLoading:!1,options:["xlsx","csv","txt"],detailForm:{taskName:"",area:"",location:"",alarmLevel:"",accesso:"",equipNumber:"",detectTime:"",inspectType:"",car:"",desc:""},videoUrl:"",imageUrl:[],videoFlag:!1,imageFlag:!1,total:0,page:1,limit:10,pageFlag:!1,detailes:[],taskTypes:[]}},mounted:function(){this.getTaskType(),this.init()},methods:{init:function(){var e=this;e.alarmInfoArr=[];var t={current:e.page,limit:e.limit,startTime:e.startVal,endTime:e.endVal,isExitAlarm:e.condition};Object(u["g"])(t).then((function(t){var a=t.data.records;e.total=t.data.total,t.data.total>0?e.exportVisible=!0:e.exportVisible=!1;for(var i=function(t,i){var n={id:a[t].ID,planID:a[t].PlanID,planName:a[t].PlanName,taskID:a[t].TaskID,carrierID:a[t].CarrierID,carrierName:a[t].CarrierName,areaId:a[t].AreaID,area:a[t].AreaName,operateType:a[t].OperateType,detectionType:a[t].DetectionType,isAlarm:a[t].AlarmCount,startTime:a[t].StartTime,endTime:a[t].EndTime};e.taskTypes&&e.taskTypes.length&&(n.taskType=e.taskTypes.find((function(e){return e.Code===n.operateType})).Desc),e.alarmInfoArr.push(n)},n=0,r=a.length;n<r;n++)i(n,r)})).catch((function(t){e.$notify({title:e.$t("user.Failure"),message:e.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))},downDialog:function(){this.dialogFormVisible=!0,this.filename=""},findInfo:function(){var e=this;this.pageFlag=!0,e.alarmInfoArr=[];var t={current:e.page,limit:e.limit,startTime:e.startVal,endTime:e.endVal,isExitAlarm:e.condition};Object(u["g"])(t).then((function(t){var a=t.data.records;t.data.total?(e.total=t.data.total,e.exportVisible=!0):e.exportVisible=!1;for(var i=0,n=a.length;i<n;i++){var r={id:a[i].id,planID:a[i].PlanID,planName:a[i].planName,taskID:a[i].taskID,carrierID:a[i].carrierID,carrierName:a[i].carrierName,areaId:a[i].areaID,area:a[i].areaName,operateType:a[i].operateType,detectionType:a[i].detectionType,isAlarm:a[i].alarm,startTime:a[i].startTime,endTime:a[i].endTime};e.alarmInfoArr.push(r)}})).catch((function(t){e.$notify({title:e.$t("user.Failure"),message:e.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))},setPage:function(){this.pageFlag?this.findInfo():this.init()},handleDownload:function(){var e=this;this.fileName?(this.downloadLoading=!0,Promise.all([a.e("chunk-0dab76e4"),a.e("chunk-58537f8d")]).then(a.bind(null,"4bf8d")).then((function(t){var a=["计划名称","小车名称","操作类型","是否有告警","开始时间","结束时间"],i=["planName","carrierName","taskType","isAlarm","startTime","endTime"],n=e.formatJson(i);t.export_json_to_excel({header:a,data:n,filename:e.fileName,bookType:e.textType}),e.downloadLoading=!1,e.fileName="",e.textType="xlsx",e.dialogFormVisible=!1}))):this.$notify({message:"请输入文件名称",type:"error",title:"提示",duration:1e3})},formatJson:function(e){return this.alarmInfoArr.map((function(t){return e.map((function(e){return"detectTime"===e?c(t[e]):"isAlarm"===e?t[e]>0?"是":"否":t[e]}))}))},cancel:function(){this.dialogFormVisible=!1,this.fileName="",this.textType="xlsx"},showDetail:function(e){var t=this,a=this;this.dialogDetailFlag=!0,this.devServer;var i={patrolRecordID:e.id};Object(u["h"])(i).then(function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(a){var i,n,l,o;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(2e4===a.code){e.next=2;break}return e.abrupt("return");case 2:t.detailes=[],i=a.data,t.videoUrl="",n=Object(r["a"])().mark((function e(a,n){var l;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1!=i[a].FileType){e.next=7;break}t.imageFlag=!0,t.detailForm.inspectType=i[a].FileTypeDescription,l="/api/PatrolFile/GetPhotoData?fileID="+i[a].ID,t.detailes.push({url:l,type:1}),e.next=11;break;case 7:if(4!=i[a].FileType){e.next=11;break}return t.videoFlag=!0,e.next=11,t.$nextTick((function(){t.detailForm.inspectType=i[a].FileTypeDescription,t.videoUrl="/api/PatrolFile/GetVideoData?fileID="+i[a].ID,t.detailes.push({url:t.videoUrl,type:2})}));case 11:case"end":return e.stop()}}),e)})),l=0,o=i.length;case 7:if(!(l<o)){e.next=12;break}return e.delegateYield(n(l,o),"t0",9);case 9:l++,e.next=7;break;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){a.$notify({title:a.$t("user.Failure"),message:a.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))},getTaskType:function(){var e=Object(l["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["j"])();case 2:t=e.sent,2e4===t.code&&(this.taskTypes=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},f=m,g=(a("bfea"),a("2877")),h=Object(g["a"])(f,i,n,!1,null,"03602533",null);t["default"]=h.exports},bfea:function(e,t,a){"use strict";a("3964")},c54f:function(e,t,a){}}]);