(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9dcaa5aa"],{"3b57":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"content-header"},[n("div",{staticClass:"headerBtn"},[n("el-button",{attrs:{size:"mini"},on:{click:e.add}},[e._v("新增角色")])],1)]),e._v(" "),n("div",{staticClass:"content-body"},[[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleList}},[n("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),e._v(" "),n("el-table-column",{attrs:{prop:"RoleCode",align:"center",label:"角色编号"}}),e._v(" "),n("el-table-column",{attrs:{prop:"RoleName",align:"center",label:"角色名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"RoleDesc",align:"center",label:"角色描述"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v("\n            "+e._s(n.CreateTime)+"\n          ")]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",plain:""},on:{click:function(t){return e.edit(r)}}},[e._v("\n              修改\n            ")]),e._v(" "),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.delRole(r.ID)}}},[e._v("\n              删除\n            ")])]}}])})],1)],e._v(" "),n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,background:"",layout:"total, prev, pager, next, jumper",total:e.total,size:"mini"},on:{"current-change":e.handleCurrentChange}})],1)],2),e._v(" "),n("el-dialog",{attrs:{title:e.form.isEdit?"编辑角色":"新增角色",visible:e.centerDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[n("el-form",{ref:"form",staticClass:"form",attrs:{rules:e.rules,model:e.form,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"角色编号",prop:"RoleCode"}},[n("el-input",{attrs:{placeholder:"请输入角色编号"},model:{value:e.form.RoleCode,callback:function(t){e.$set(e.form,"RoleCode","string"===typeof t?t.trim():t)},expression:"form.RoleCode"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"角色名称",prop:"RoleName"}},[n("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.RoleName,callback:function(t){e.$set(e.form,"RoleName","string"===typeof t?t.trim():t)},expression:"form.RoleName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"描述信息",prop:"RoleDesc"}},[n("el-input",{staticStyle:{margin:"10px 0"},attrs:{type:"textarea",maxlength:"100",placeholder:"请输入描述信息"},model:{value:e.form.RoleDesc,callback:function(t){e.$set(e.form,"RoleDesc","string"===typeof t?t.trim():t)},expression:"form.RoleDesc"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"所属权限",prop:"PowerList"}},[n("el-tree",{ref:"tree",staticStyle:{"margin-bottom":"24px","margin-top":"10px"},attrs:{data:e.powerList,"show-checkbox":"","node-key":"ID",accordion:"",props:e.defaultProps,"expand-on-click-node":!1},on:{check:e.nodeCheck}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e.form.isEdit?"保存编辑":"立即新增"))]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)],1)},o=[],a=n("2909"),i=(n("ac6a"),n("5530")),c=n("c7eb"),s=(n("96cf"),n("1da1")),l=n("8996"),u={data:function(){return{centerDialogVisible:!1,form:{RoleCode:"",PowerList:null},powerList:[],roleList:[],currentPage:1,total:0,searchLoding:!1,rules:{RoleCode:[{required:!0,message:"请输入角色编号",trigger:"blur"}],RoleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],RoleDesc:[{required:!0,message:"请输入描述信息",trigger:"blur"}]},defaultProps:{children:"children",label:"PowerName"}}},mounted:function(){this.init()},methods:{init:function(){this.getPowers(),this.getRoleManageList()},getRoleManageList:function(){var e=Object(s["a"])(Object(c["a"])().mark((function e(){var t,n;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.currentPage,e.next=3,Object(l["h"])({current:t,limit:10});case 3:n=e.sent,2e4===n.code&&(this.roleList=(n.data||{}).records||[],this.total=(n.data||{}).total||0,this.total=(n.data||{}).total||0);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),add:function(){var e=this;this.form.isEdit=!1,this.form={RoleName:"",RoleCode:"",RoleDesc:"",PowerList:null},this.centerDialogVisible=!0,this.$nextTick((function(){e.$refs.form.clearValidate(),e.$refs.tree.setCheckedKeys([])}))},handleCurrentChange:function(e){this.currentPage=e,this.getRoleManageList()},delRole:function(e){var t=this;this.$confirm("此操作将永久删除数据，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(Object(c["a"])().mark((function n(){var r;return Object(c["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(l["c"])({roleID:e});case 2:r=n.sent,2e4===r.code&&(t.$notify({message:r.data,type:"success",title:"提示",duration:1e3}),t.getRoleManageList());case 4:case"end":return n.stop()}}),n)})))).catch((function(){}))},addUserRole:function(){var e=Object(s["a"])(Object(c["a"])().mark((function e(){var t,n,r,o,a,i,s,u,d;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.form,n=t.isEdit,r=t.RoleCode,o=t.RoleName,a=t.PowerList,i=t.RoleDesc,s=t.ID,u={},d={powerList:a,roleCode:r,roleDesc:i,roleName:o,roleID:s},!n){e.next=9;break}return e.next=6,Object(l["l"])(d);case 6:u=e.sent,e.next=12;break;case 9:return e.next=11,Object(l["a"])(d);case 11:u=e.sent;case 12:2e4===u.code&&(this.$notify({message:u.data,type:"success",title:"提示",duration:1e3}),this.getRoleManageList(),this.centerDialogVisible=!1);case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),save:function(){var e=this;this.$refs.form.validate((function(t){t&&e.addUserRole()}))},cancel:function(){this.centerDialogVisible=!1},edit:function(){var e=Object(s["a"])(Object(c["a"])().mark((function e(t){var n,r=this;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$nextTick((function(){r.$refs.form.clearValidate()})),this.form=Object(i["a"])({},t),e.next=4,Object(l["f"])({roleID:t.ID});case 4:n=e.sent,2e4===n.code&&(this.form.isEdit=!0,this.centerDialogVisible=!0,this.$nextTick((function(){var e=(n.data||[]).map((function(e){return e.id}));r.form.PowerList=e||[],r.powerList&&(r.powerList.forEach((function(t){t.children&&e&&t.children.forEach((function(n){e.some((function(e){return e===n.ID}))||(e=e.filter((function(e){return e!==t.ID}))),n.children&&e&&n.children.forEach((function(t){e.some((function(e){return e===n.ID}))||(e=e.filter((function(e){return e!==n.ID})))}))}))})),r.$refs.tree.setCheckedKeys(e))})));case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getPowers:function(){var e=Object(s["a"])(Object(c["a"])().mark((function e(){var t,n,r,o,a;return Object(c["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["e"])();case 2:if(t=e.sent,2e4!==t.code){e.next=14;break}if(n=t.data||[],r=[],o=[],a=[],n&&n.length){e.next=10;break}return e.abrupt("return");case 10:n.forEach((function(e){1===e.PowerLevel?(e.children=[],r.push(e)):2===e.PowerLevel?(e.children=[],o.push(e)):3===e.PowerLevel&&a.push(e)})),a&&o&&a.forEach((function(e){o.forEach((function(t){e.ParentID===t.ID&&t.children.push(e)}))})),o&&r&&o.forEach((function(e){r.forEach((function(t){e.ParentID===t.ID&&t.children.push(e)}))})),this.powerList=r;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),nodeCheck:function(e,t){var n=t.checkedKeys,r=t.halfCheckedKeys;this.form.PowerList=[].concat(Object(a["a"])(n),Object(a["a"])(r))}}},d=u,f=(n("78e9"),n("2877")),p=Object(f["a"])(d,r,o,!1,null,"20fa4127",null);t["default"]=p.exports},"78e9":function(e,t,n){"use strict";n("b900")},8996:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"m",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"l",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return b}));var r=n("b775");function o(){return Object(r["a"])({url:"/api/Role/getRole",method:"get"})}function a(e){return Object(r["a"])({url:"/api/User/getUserList",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/api/User/deleteUser",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/api/User/addUser",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/api/User/updateUser",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/api/Role/getRoleList",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/api/Role/deleteRole",method:"post",data:e})}function d(e){return Object(r["a"])({url:"/api/Role/addRole",method:"post",data:e})}function f(e){return Object(r["a"])({url:"/api/Role/updateRole",method:"post",data:e})}function p(e){return Object(r["a"])({url:"/api/Power/getPowerList",method:"get"})}function h(e){return Object(r["a"])({url:"/api/Power/getPowerListByRoleID",method:"post",data:e})}function m(){return Object(r["a"])({url:"/api/SystemConfig/GetSystemXmlConfig",method:"get"})}function b(e){return Object(r["a"])({url:"/api/SystemConfig/SetSystemXmlConfig",method:"post",data:e})}},b900:function(e,t,n){}}]);