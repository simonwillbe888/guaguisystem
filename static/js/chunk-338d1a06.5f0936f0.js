(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-338d1a06"],{"0dbe":function(t,e,a){"use strict";a.d(e,"h",(function(){return r})),a.d(e,"b",(function(){return i})),a.d(e,"e",(function(){return s})),a.d(e,"t",(function(){return o})),a.d(e,"i",(function(){return l})),a.d(e,"c",(function(){return c})),a.d(e,"f",(function(){return u})),a.d(e,"u",(function(){return p})),a.d(e,"k",(function(){return d})),a.d(e,"j",(function(){return f})),a.d(e,"o",(function(){return m})),a.d(e,"d",(function(){return h})),a.d(e,"g",(function(){return g})),a.d(e,"v",(function(){return b})),a.d(e,"l",(function(){return _})),a.d(e,"p",(function(){return v})),a.d(e,"a",(function(){return k})),a.d(e,"n",(function(){return y})),a.d(e,"q",(function(){return P})),a.d(e,"m",(function(){return $})),a.d(e,"r",(function(){return T})),a.d(e,"s",(function(){return I}));var n=a("b775");function r(){return Object(n["a"])({url:"/api/PatrolLocation/GetAllPatrolLocation",method:"get"})}function i(t){return Object(n["a"])({url:"/api/PatrolLocation/AddPatrolLocation",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/api/PatrolLocation/DeletePatrolLocation",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/api/PatrolLocation/UpdatePatrolLocation",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/api/PatrolPlan/getAllPatrolPlan",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/api/PatrolPlan/addPatrolPlan",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/api/PatrolPlan/deletePatrolPlan",method:"post",params:t})}function p(t){return Object(n["a"])({url:"/api/PatrolPlan/updatePatrolPlan",method:"post",data:t})}function d(){return Object(n["a"])({url:"/api/PatrolPlan/getPlanTypeList",method:"get"})}function f(){return Object(n["a"])({url:"/api/PatrolTemplate/getPatrolTemplateList",method:"get"})}function m(){return Object(n["a"])({url:"/api/PatrolTemplate/getPatrolTemplateSelectList",method:"get"})}function h(t){return Object(n["a"])({url:"/api/PatrolTemplate/addPatrolTemplate",method:"post",data:t})}function g(t){return Object(n["a"])({url:"/api/PatrolTemplate/deletePatrolTemplate",method:"post",params:{ID:t}})}function b(t){return Object(n["a"])({url:"/api/PatrolTemplate/updatePatrolTemplate",method:"post",data:t})}function _(){return Object(n["a"])({url:"/api/CarrierSet/getCarrierTypeList",method:"get"})}function v(t){return Object(n["a"])({url:"/api/PatrolTemplateItem/getPatrolTemplateItemList?taskTemplateId="+t.id,method:"post"})}function k(t){return Object(n["a"])({url:"/api/PatrolTemplateItem/savePatrolTemplateItem",method:"post",data:t})}function y(){return Object(n["a"])({url:"/api/PatrolPlan/getFrequencyTypeList",method:"get"})}function P(){return Object(n["a"])({url:"/api/PatrolPlan/getPlanEnableList",method:"get"})}function $(){return Object(n["a"])({url:"/api/PatrolPlan/getExecuteTypeList",method:"get"})}function T(t){return Object(n["a"])({url:"/api/PatrolPlan/startPatrolPlan?ID="+t,method:"post"})}function I(t){return Object(n["a"])({url:"/api/PatrolPlan/stopPatrolPlan?ID="+t,method:"post"})}},5268:function(t,e,a){"use strict";a("cc96")},"5a74":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"1%"}},[a("div",{staticClass:"inspection-header content-header"},[a("div",{staticClass:"inspec-setting-inquire"},[a("el-button",{staticClass:"inspect-operate",attrs:{type:"success",size:"mini"},on:{click:function(e){return t.addInspectTask()}}},[t._v(t._s(t.$t("process_config.addInspectTask_label")))])],1)]),t._v(" "),a("div",{staticClass:"robot-body content-body"},[a("div",{staticClass:"inspectTask-table"},[a("el-table",{ref:"singleTable",staticClass:"inspect-task",attrs:{data:t.processTaskArr,"header-row-class-name":"header-row-class","row-class-name":"row-class",fit:"","highlight-current-row":"",size:"small"}},[a("el-table-column",{attrs:{type:"index",label:"序号",fixed:"left",align:"center",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"process_name",label:"流程名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.process_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"map_name",label:"地图显示名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.map_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",[t._v(t._s(n.createTime))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"operate",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-s-tools",size:"mini",plain:""},on:{click:function(e){return t.configInspectPoint(n)}}},[t._v("配置流程")]),t._v(" "),a("el-button",{staticClass:"process-operate",attrs:{type:"primary",icon:"el-icon-edit",size:"mini",plain:""},on:{click:function(e){return t.editInspectTask(n)}}},[t._v(t._s(t.$t("process_config.edit_label")))]),t._v(" "),a("el-button",{staticClass:"process-operate",attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteInspectTask(n)}}},[t._v(t._s(t.$t("process_config.delete_label")))])]}}])})],1)],1)]),t._v(" "),a("div",{staticClass:"dialog-sty"},[a("el-dialog",{staticStyle:{width:"50%","margin-left":"25%"},attrs:{title:t.taskDialog[t.dialogType],visible:t.processDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.processDialogVisible=e}}},[a("el-form",{ref:"taskForm",attrs:{"label-width":"120px",model:t.taskForm,rules:t.rules}},[a("el-form-item",{attrs:{label:"流程名称",prop:"processName"}},[a("el-input",{staticClass:"process-input",attrs:{placeholder:"请输入流程名称"},model:{value:t.taskForm.processName,callback:function(e){t.$set(t.taskForm,"processName",e)},expression:"taskForm.processName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"地图显示名称",prop:"mapName"}},[a("el-input",{staticClass:"process-input",attrs:{placeholder:"请输入地图名称"},model:{value:t.taskForm.mapName,callback:function(e){t.$set(t.taskForm,"mapName",e)},expression:"taskForm.mapName"}})],1),t._v(" "),a("el-form-item",{staticClass:"common-form-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){"addInspectsTask"===t.dialogType?t.addSuccess("taskForm",t.taskForm):t.editSuccess("taskForm",t.taskForm)}}},[t._v(t._s(t.$t("inspection_setting.sure_add_label")))]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.cancel("taskForm")}}},[t._v(t._s(t.$t("inspection_setting.cancel_add_label")))])],1)],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.$t("process_config.config_inspectTask"),visible:t.dialogFormVisible,center:""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticStyle:{"background-color":"lightblue"}},[a("el-divider",{attrs:{"content-position":"left"}},[a("div",{staticStyle:{padding:"8px 2px"}},[a("span",{staticStyle:{"font-size":"16px",color:"rgb(48, 29, 15)"}},[t._v(t._s(t.$t("process_config.taskInspect_point")))])])])],1),t._v(" "),a("div",{staticClass:"inspect-point"},[a("el-transfer",{staticStyle:{"text-align":"left",display:"inline-block","font-size":"12px"},attrs:{titles:["巡检点列表","目标巡检点"],"button-texts":["到左边","到右边"],filterable:"","filter-method":t.filterMethod,"target-order":"push","filter-placeholder":"请输入巡检点名称","render-content":t.renderFunc,data:t.$root.allInspectArr,"left-default-checked":t.hasCheckedWHLeftData},on:{"left-check-change":t.handleWHLeftChange},model:{value:t.$root.inspectsVal,callback:function(e){t.$set(t.$root,"inspectsVal",e)},expression:"$root.inspectsVal"}})],1),t._v(" "),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.add()}}},[t._v(t._s(t.$t("process_config.sure_add_label")))]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(t._s(t.$t("process_config.cancel_add_label")))])],1)])],1)},r=[],i=(a("1c4c"),a("ac6a"),a("5df3"),a("4f7f"),a("20d6"),a("7f7f"),a("aa47")),s=a("0dbe"),o=[],l={data:function(){this.$createElement;return{renderFunc:function(t,e){return t("span",[e.label])},filterMethod:function(t,e){return e.label.indexOf(t)>-1},inquireVal:"",processTaskArr:[],dialogFormVisible:!1,processDialogVisible:!1,dialogType:"",taskDialog:{addInspectsTask:this.$t("process_config.addInspectTask_label"),editInspectsTask:this.$t("process_config.editInspectTask_label")},taskForm:{processId:"",processName:"",mapName:"",inspectedTask:"",inspectedId:"",inspectedPoint:""},rules:{processName:[{required:!0,message:"请输流程名称",trigger:"change"}]},currentRobot:"",currentInspectPoint:"",checkAll:!1,checkedPoints:[],points:o,isIndeterminate:!0,inspectPoints:"",currentRow:null,hasCheckedWHLeftData:[],ID:0}},mounted:function(){this.initProcessConfig()},methods:{getTaskPrograssList:function(){var t=this;t.processTaskArr=[],Object(s["j"])().then((function(e){console.log("查看巡检计划",e.data);var a=e.data;if(a.length)for(var n=0,r=a.length;n<r;n++){var i={process_id:a[n].id,process_name:a[n].taskName,map_name:a[n].mapDisplayName,createTime:a[n].createTime};t.processTaskArr.push(i)}})).catch((function(e){t.$notify({title:t.$t("user.Failure"),message:t.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))},initProcessConfig:function(){var t=this;t.processTaskArr=[],this.$root.allInspectArr=[],this.getTaskPrograssList(),Object(s["h"])().then((function(e){console.log("查看巡检点",e.data);var a=e.data;if(a.length)for(var n=0,r=a.length;n<r;n++){var i={key:a[n].locationID,label:a[n].name};t.$root.allInspectArr.push(i)}})).catch((function(e){t.$notify({title:t.$t("user.Failure"),message:t.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))},handleChange:function(t,e,a){console.log(t,e,a)},addInspectTask:function(){var t=this;this.processDialogVisible=!0,this.dialogType="addInspectsTask",this.taskForm={processName:"",mapName:""},this.$nextTick((function(){t.$refs.taskForm.clearValidate()}))},editInspectTask:function(t){t&&(this.processDialogVisible=!0,this.dialogType="editInspectsTask",this.ID=t.process_id,this.taskForm={processName:t.process_name,mapName:t.map_name})},addSuccess:function(t,e){var a=this,n=this;this.$refs[t].validate((function(r){if(!r)return console.log("error submit!!"),!1;var i={taskName:e.processName,mapDisplayName:e.mapName};Object(s["d"])(i).then((function(e){2e4===e.code&&(a.$notify({type:"success",message:"新增成功！",title:"提示",duration:1e3}),n.initProcessConfig(),a.$refs[t].resetFields())})).catch((function(t){n.$notify({title:n.$t("user.Failure"),message:n.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})})),a.processDialogVisible=!1}))},editSuccess:function(t,e){var a=this,n=this;this.$refs[t].validate((function(r){if(!r)return console.log("error submit!!"),!1;var i={id:n.ID,taskName:e.processName,mapDisplayName:e.mapName};Object(s["v"])(i).then((function(e){2e4===e.code&&(a.$notify({type:"success",message:"修改成功！",title:"提示",duration:1e3}),n.initProcessConfig(),a.$refs[t].resetFields())})).catch((function(t){n.$notify({title:n.$t("user.Failure"),message:n.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})})),a.processDialogVisible=!1}))},cancel:function(t){this.$refs[t].resetFields(),this.processDialogVisible=!1},deleteInspectTask:function(t){var e=this,a=this;t&&this.$confirm(a.$t("public_vary.delete_operate_tip"),a.$t("public_vary.warning_tip"),{confirmButtonText:a.$t("public_vary.sure_label"),cancelButtonText:a.$t("public_vary.cancel_label"),type:"warning"}).then((function(){Object(s["g"])(t.process_id).then((function(t){2e4===t.code&&(e.$notify({type:"success",message:"删除成功",title:"提示",duration:1e3}),a.initProcessConfig())})).catch((function(t){a.$notify({title:a.$t("user.Failure"),message:a.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))})).catch((function(){}))},configInspectPoint:function(t){this.$router.push({name:"action_actionManage_label",query:{id:t.process_id,title:t.process_name}})},add:function(){var t=this,e=this,a=[];this.$root.inspectsVal.length&&function(){for(var e=t.$root.allInspectArr.filter((function(t){return"错误点"===t.label})),n=function(a,n){var r=t.$root.inspectsVal.findIndex((function(t){return t===e[a].key}));-1!==r&&t.$root.inspectsVal.splice(r,1)},r=0,i=e.length;r<i;++r)n(r,i);for(var s=0,o=t.$root.inspectsVal.length;s<o;s++){var l={Sequence:s+1,LocationID:t.$root.inspectsVal[s]};a.push(l)}}();var n={ID:this.inspectPoints.process_id,TaskTemplateName:this.inspectPoints.process_name,MapDisplayName:this.inspectPoints.map_name,ItemObj:a};Object(s["v"])(n).then((function(a){2e4===a.code&&(t.$notify({type:"success",message:"修改成功",title:"提示",duration:1e3}),e.initProcessConfig())})).catch((function(t){e.$notify({title:e.$t("user.Failure"),message:e.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})})),this.dialogFormVisible=!1},handleCheckAllChange:function(t){this.checkedPoints=t?o:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(t){var e=t.length;this.checkAll=e===this.points.length,this.isIndeterminate=e>0&&e<this.points.length},drag:function(){var t=this,e=document.querySelector(".el-transfer").querySelectorAll(".el-checkbox-group")[1];new i["a"](e,{forceFallback:!1,onUpdate:function(e){var a=t.$el.querySelector(".el-transfer").querySelectorAll(".el-checkbox-group")[1],n=t.$el.querySelector(".el-transfer").querySelectorAll(".el-checkbox-group")[1].childNodes.length;if(!(e.newIndex>=n)){var r=e.newIndex,i=e.oldIndex,s=a.children[r],o=a.children[i];a.removeChild(s),r<i?a.insertBefore(s,o):a.insertBefore(s,o.nextSibling);var l=t.$root.inspectsVal.splice(i,1);t.$root.inspectsVal.splice(r,0,l[0])}}})},handleWHLeftChange:function(t,e){var a=this;a.hasCheckedWHLeftData=a.commonChangeFuc(t,e,a.hasCheckedWHLeftData,a.firstWHLeftLocation,a.lastWHLeftLocation,a.data,"id"),this.drag()},commonChangeFuc:function(t,e,a,n,r,i,s){for(var o=this,l=!1,c=0;c<t.length;c++)t[c]==e[0]&&(l=!0);if(l){if(1==t.length)n=0,a.push(t[0]);else if(t.length>1){if(o.shiftKey){for(var u=0;u<i.length;u++){var p=s?i[u][s]:i[u];p==t[t.length-2]&&(n=u),p==e[0]&&(r=u)}if(-1!=n&&-1!=r)if(n<r)for(var d=0;d<i.length;d++){var f=s?i[d][s]:i[d];d>=n&&d<=r&&a.push(f)}else if(n>r)for(d=0;d<i.length;d++)d>=r&&d<=n&&a.push(item)}else a.push(e[0])}}else{a=[];for(c=0;c<t.length;c++)t[c]!=e[0]&&a.push(t[c])}return a=new Set(a),a=Array.from(a),a}}},c=l,u=(a("5268"),a("2877")),p=Object(u["a"])(c,n,r,!1,null,"2182b3ae",null);e["default"]=p.exports},cc96:function(t,e,a){}}]);