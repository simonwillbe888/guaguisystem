(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07a93e04"],{"333d":function(a,e,t){"use strict";var r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"pagination-container",class:{hidden:a.hidden}},[t("el-pagination",a._b({attrs:{background:a.background,"current-page":a.currentPage,"page-size":a.pageSize,layout:a.layout,"page-sizes":a.pageSizes,total:a.total},on:{"update:currentPage":function(e){a.currentPage=e},"update:current-page":function(e){a.currentPage=e},"update:pageSize":function(e){a.pageSize=e},"update:page-size":function(e){a.pageSize=e},"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}},"el-pagination",a.$attrs,!1))],1)},l=[];t("c5f6");Math.easeInOutQuad=function(a,e,t,r){return a/=r/2,a<1?t/2*a*a+e:(a--,-t/2*(a*(a-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();function n(a){document.documentElement.scrollTop=a,document.body.parentNode.scrollTop=a,document.body.scrollTop=a}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function c(a,e,t){var r=o(),l=a-r,c=20,m=0;e="undefined"===typeof e?500:e;var s=function a(){m+=c;var o=Math.easeInOutQuad(m,r,l,e);n(o),m<e?i(a):t&&"function"===typeof t&&t()};s()}var m={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(a){this.$emit("update:page",a)}},pageSize:{get:function(){return this.limit},set:function(a){this.$emit("update:limit",a)}}},methods:{handleSizeChange:function(a){this.$emit("pagination",{page:this.currentPage,limit:a}),this.autoScroll&&c(0,800)},handleCurrentChange:function(a){this.$emit("pagination",{page:a,limit:this.pageSize}),this.autoScroll&&c(0,800)}}},s=m,u=(t("9567"),t("2877")),d=Object(u["a"])(s,r,l,!1,null,"2fa86365",null);e["a"]=d.exports},3816:function(a,e,t){"use strict";t.d(e,"h",(function(){return l})),t.d(e,"g",(function(){return i})),t.d(e,"f",(function(){return n})),t.d(e,"e",(function(){return o})),t.d(e,"d",(function(){return c})),t.d(e,"b",(function(){return m})),t.d(e,"c",(function(){return s})),t.d(e,"i",(function(){return u})),t.d(e,"a",(function(){return d})),t.d(e,"j",(function(){return p}));var r=t("b775");function l(a){return Object(r["a"])({url:"/api/PatrolFile/getPatrolFileList",method:"post",data:a})}function i(a){return Object(r["a"])({url:"/api/PatrolRecord/getPatrolRecordList",method:"post",data:a})}function n(a){return Object(r["a"])({url:"/api/AlarmRecord/getCurrentAlarmRecordList",method:"post",data:a})}function o(){return Object(r["a"])({url:"/api/AlarmRecord/getAlarmStateList",method:"get"})}function c(a){return Object(r["a"])({url:"/api/AlarmRecord/getAlarmRecordList",method:"post",data:a})}function m(a){return Object(r["a"])({url:"/api/AlarmRecord/dealAlarm",method:"post",data:a})}function s(a){return Object(r["a"])({url:"/api/AlarmRecord/getAlarmDealLog",method:"post",params:a})}function u(){return Object(r["a"])({url:"/api/PatrolTask/GetRealPatrolTaskList",method:"get"})}function d(a){return Object(r["a"])({url:"/api/PatrolTask/CancelPatrolTask",method:"post",data:a})}function p(){return Object(r["a"])({url:"/api/PatrolRecord/getPatrolActionTypeList",method:"get"})}},"4b7c":function(a,e,t){"use strict";t.r(e);var r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticStyle:{padding:"1%"}},[t("div",{staticClass:"equip-header content-header"},[t("el-select",{attrs:{placeholder:"请选择告警状态",size:"mini",clearable:""},model:{value:a.alarmState,callback:function(e){a.alarmState=e},expression:"alarmState"}},a._l(a.alarmStateOptions,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value}})})),1),a._v("\n      \n    "),t("el-button",{attrs:{type:"primary",plain:"",size:"mini"},nativeOn:{click:function(e){return a.init()}}},[a._v("查询")])],1),a._v(" "),t("div",{staticClass:"equip-body content-body"},[t("el-table",{staticClass:"equip-data",attrs:{data:a.alarmInfoArr,"header-row-class-name":"header-row-class","row-class-name":"row-class",fit:"","highlight-current-row":"",size:"small","max-height":"440px"},on:{"row-click":a.getDetailMessage}},[t("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"100"}}),a._v(" "),t("el-table-column",{attrs:{prop:"alarmCode",label:a.$t("alarm_dealWith.alarm_code_label"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.alarmCode))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"alarmName",label:a.$t("alarm_dealWith.alarm_name_label"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.alarmName))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"alarmStatus",label:a.$t("alarm_dealWith.alarm_status_label"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.alarmStatus))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"maxAlarmLevel",label:a.$t("alarm_dealWith.maxAlarm_level_label"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.maxAlarmLevel))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"maxAlarmValue",label:a.$t("alarm_dealWith.maxAlarm_value_label"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.maxAlarmValue))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"machineName",label:a.$t("alarm_dealWith.machine_name_label"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.machineName))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"equipmentName",label:a.$t("alarm_dealWith.equipment_name_label"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.equipmentName))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"happenTime",label:a.$t("alarm_dealWith.happen_time"),align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("span",[a._v(a._s(r.happenTime))])]}}])}),a._v(" "),t("el-table-column",{attrs:{prop:"details",label:"操作",align:"center",width:"120"},scopedSlots:a._u([{key:"default",fn:function(e){var r=e.row;return[t("el-button",{attrs:{type:"primary",icon:"el-icon-document",size:"mini",plain:""},on:{click:function(e){return a.showDetail(r)}}},[a._v(a._s(a.$t("public_vary.dealWith_label")))])]}}])})],1),a._v(" "),t("el-dialog",{attrs:{title:"告警详情",visible:a.dialogVisible,width:"60%"},on:{"update:visible":function(e){a.dialogVisible=e}}},[t("div",{staticStyle:{display:"flex"}},[t("img",{staticStyle:{width:"70%"},attrs:{src:a.imageUrl,alt:""}}),a._v(" "),t("div",{staticStyle:{"margin-left":"2vw"}},[t("div",{staticStyle:{margin:"1vh  0"}},[a._v("警告级别: \n            "),4==a.alarm.maxAlarmLevel?t("span",{staticStyle:{border:"red 1px solid",color:"red","font-size":"1.2vw"}},[a._v("致命")]):a._e(),a._v(" "),3==a.alarm.maxAlarmLevel?t("span",{staticStyle:{border:"red 1px solid",color:"orange","font-size":"1.2vw"}},[a._v("严重")]):a._e(),a._v(" "),2==a.alarm.maxAlarmLevel?t("span",{staticStyle:{border:"red 1px solid",color:"yellow","font-size":"1vw"}},[a._v("一般")]):a._e(),a._v(" "),1==a.alarm.maxAlarmLevel?t("span",{staticStyle:{border:"red 1px solid",color:"#08F9EB","font-size":"1vw"}},[a._v("提示")]):a._e()]),a._v(" "),t("div",{staticStyle:{margin:"2vh  0"}},[a._v("\n            告警名称："+a._s(a.alarm.alarmName)+"\n          ")]),a._v(" "),t("div",{staticStyle:{margin:"3vh  0"}},[a._v("\n            告警编号："+a._s(a.alarm.id)+"\n          ")]),a._v(" "),t("div",{staticStyle:{margin:"3vh  0"}},[a._v("\n            告警类型："+a._s(1001==a.alarm.alarmCode?"行人警告":1002==a.alarm.alarmCode?"非机动车告警":1003==a.alarm.alarmCode?"异物警告":1004==a.alarm.alarmCode?"温度警告":1005==a.alarm.alarmCode?"湿度警告":1006==a.alarm.alarmCode?"气体警告":1007==a.alarm.alarmCode?"灯光警告":"其他警告")+"\n          ")]),a._v(" "),t("div",{staticStyle:{margin:"3vh 0"}},[a._v("\n            事件描述："+a._s(a.alarm.Description)+"\n          ")]),a._v(" "),t("div",{staticStyle:{margin:"3vh 0"}},[a._v("\n            告警位置："+a._s(a.alarm.X)+","+a._s(a.alarm.Y)+"\n          ")]),a._v(" "),t("div",{staticStyle:{margin:"3vh  0"}},[a._v("\n            发生时间："+a._s(a.alarm.happenTime)+"\n          ")]),a._v(" "),t("div",{staticStyle:{margin:"3vh  0"}},[a._v("\n            修复时间："+a._s(null==a.alarm.RecoveryTime?"未修复":a.alarm.RecoveryTime)+"\n          ")])])]),a._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){a.dialogVisible=!1}}},[a._v("取 消")]),a._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(e){a.dialogVisible=!1}}},[a._v("确 定")])],1)]),a._v(" "),t("div",[t("pagination",{directives:[{name:"show",rawName:"v-show",value:a.total>0,expression:"total > 0"}],attrs:{total:a.total,page:a.page,limit:a.limit},on:{"update:page":function(e){a.page=e},"update:limit":function(e){a.limit=e},pagination:a.init}})],1)],1),a._v(" "),t("el-dialog",{staticClass:"dialog-class",attrs:{title:a.$t("alarm_dealWith.alarm_dealWith_label"),visible:a.dialogDetailFlag},on:{"update:visible":function(e){a.dialogDetailFlag=e},close:function(e){return a.cancel()}}},[t("el-form",{ref:"alarmForm",staticClass:"common-form",attrs:{"label-position":"left","label-width":"120px",model:a.alarmForm,rules:a.rules}},[t("el-divider",{attrs:{"content-position":"left"}},[a._v("告警信息")]),a._v(" "),t("el-form-item",{attrs:{label:a.$t("alarm_dealWith.alarm_code_label"),"label-width":a.formLabelWidth,prop:"alarmCode"}},[t("el-input",{model:{value:a.alarmForm.alarmCode,callback:function(e){a.$set(a.alarmForm,"alarmCode",e)},expression:"alarmForm.alarmCode"}})],1),a._v(" "),t("el-form-item",{attrs:{label:a.$t("alarm_dealWith.alarm_name_label"),"label-width":a.formLabelWidth,prop:"alarmName"}},[t("el-input",{model:{value:a.alarmForm.alarmName,callback:function(e){a.$set(a.alarmForm,"alarmName",e)},expression:"alarmForm.alarmName"}})],1),a._v(" "),t("el-divider",{attrs:{"content-position":"left"}},[a._v("告警处理")]),a._v(" "),t("el-form-item",{attrs:{label:a.$t("alarm_dealWith.dealWith_way_label"),"label-width":a.formLabelWidth,prop:"dealWithWay"}},[t("el-input",{model:{value:a.alarmForm.dealWithWay,callback:function(e){a.$set(a.alarmForm,"dealWithWay",e)},expression:"alarmForm.dealWithWay"}})],1),a._v(" "),t("el-form-item",{attrs:{label:a.$t("alarm_dealWith.dealWith_describe_label"),"label-width":a.formLabelWidth,prop:"dealWithDescribe"}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:a.alarmForm.dealWithDescribe,callback:function(e){a.$set(a.alarmForm,"dealWithDescribe",e)},expression:"alarmForm.dealWithDescribe"}})],1),a._v(" "),t("el-form-item",{staticClass:"common-form-footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(e){return a.addSuccess("alarmForm",a.alarmForm)}}},[a._v(a._s(a.$t("inspection_setting.sure_add_label")))]),a._v(" "),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return a.cancel("alarmForm")}}},[a._v(a._s(a.$t("inspection_setting.cancel_add_label")))])],1)],1)],1)],1)},l=[],i=(t("c5f6"),t("ac6a"),t("ade3")),n=(t("7514"),t("c7eb")),o=(t("96cf"),t("1da1")),c=t("5530"),m=t("3816"),s=t("333d"),u=t("2f62"),d={components:{Pagination:s["a"]},data:function(){return{activeName:"1",alarmState:"",alarmStateOptions:[],refreshTimer:null,alarmInfoArr:[],dialogDetailFlag:!1,formLabelWidth:"110px",alarm:[],alarmForm:{id:"",patrolRecordID:"",alarmCode:"",alarmName:"",dealWithWay:"",dealWithDescribe:""},rules:{dealWithWay:[{required:!0,message:"请输入处理方式",trigger:"change"}],dealWithDescribe:[{required:!0,message:"请输入处理描述",trigger:"change"}]},carAlarmFlag:!1,inspectAlarmFlag:!1,total:0,page:1,limit:10,dialogVisible:!1,imageUrl:null}},computed:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["realTimeAlarm"])),{},{realTimeAlarminfo:function(){return this.realTimeAlarm[0]}}),watch:{realTimeAlarminfo:function(){this.initAlarmState()}},beforeDestroy:function(){clearTimeout(this.refreshTimer),this.refreshTimer=null},mounted:function(){this.initAlarmState()},methods:{init:function(){var a=this,e={current:a.page,limit:a.limit,status:a.alarmState};Object(m["f"])(e).then((function(e){console.log("查看输出的",e),a.total=e.data.total;for(var t=e.data.records,r=[],l=function(e,l){var n,o=a.alarmStateOptions.find((function(a){return a.value===t[e].Status})).label,c=(n={id:t[e].ID,alarmCode:t[e].AlarmCode,alarmName:t[e].AlarmName,maxAlarmLevel:t[e].MaxLevel,maxAlarmValue:t[e].HighValue},Object(i["a"])(n,"alarmCode",t[e].AlarmCode),Object(i["a"])(n,"machineName",t[e].CarrierName),Object(i["a"])(n,"equipmentName",t[e].CarrierName),Object(i["a"])(n,"alarmStatus",o),Object(i["a"])(n,"statusNum",t[e].Status),Object(i["a"])(n,"X",t[e].X),Object(i["a"])(n,"Y",t[e].Y),Object(i["a"])(n,"happenTime",t[e].ReportTime),Object(i["a"])(n,"RecoveryTime",t[e].RecoveryTime),Object(i["a"])(n,"Description",t[e].Description),Object(i["a"])(n,"Image",t[e].Image),Object(i["a"])(n,"patrolRecordID",t[e].PatrolRecordID),Object(i["a"])(n,"vertexNumber",t[e].VertexNumber),Object(i["a"])(n,"locationID",t[e].LocationID),Object(i["a"])(n,"edgeNumber",t[e].EdgeNumber),Object(i["a"])(n,"alarmType",t[e].AlarmType),n);r.push(c)},c=0,m=t.length;c<m;c++)l(c,m);a.alarmInfoArr=r,a.refreshTimer=setTimeout(Object(o["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.init();case 2:case"end":return e.stop()}}),e)}))),6e4)})).catch((function(e){a.$notify({title:a.$t("user.Failure"),message:a.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))},getDetailMessage:function(a){this.alarm=a,console.log("实时",this.alarm),this.imageUrl=a.Image,this.dialogVisible=!0},initAlarmState:function(){var a=this,e=this;Object(m["e"])().then((function(t){t&&t.data.length&&(e.alarmStateOptions=[],t.data.forEach((function(a){var t={value:a.Code,label:a.Desc};e.alarmStateOptions.push(t)})),a.init())})).catch((function(){}))},showDetail:function(a){this.dialogDetailFlag=!0,this.alarmForm.id=a.id,this.alarmForm.patrolRecordID=a.patrolRecordID,this.alarmForm.alarmCode=a.alarmCode,this.alarmForm.alarmName=a.alarmName},addSuccess:function(a,e){var t=this,r=this;this.$refs[a].validate((function(a){if(!a)return console.log("error submit!!"),!1;var l={alarmCode:e.alarmCode,alarmRecordID:Number(e.id),dealPerson:"王嗯嗯",dealResult:e.dealWithWay,description:e.dealWithDescribe,patrolRecordID:e.patrolRecordID};Object(m["b"])(l).then((function(a){2e4===a.code&&(t.$notify({type:"success",message:"删除成功！",title:"提示",duration:1e3}),r.cancel(),r.init())})).catch((function(a){r.cancel(),r.$notify({title:r.$t("user.Failure"),message:r.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))}))},resetForm:function(){this.alarmForm={id:"",patrolRecordID:"",alarmCode:"",alarmName:"",dealWithWay:"",dealWithDescribe:""}},cancel:function(a){this.$refs.alarmForm.resetFields(),this.dialogDetailFlag=!1,this.resetForm()}}},p=d,f=(t("bed6"),t("2877")),h=Object(f["a"])(p,r,l,!1,null,"0b0b369d",null);e["default"]=h.exports},9567:function(a,e,t){"use strict";t("c54f")},bed6:function(a,e,t){"use strict";t("fa91")},c54f:function(a,e,t){},fa91:function(a,e,t){}}]);