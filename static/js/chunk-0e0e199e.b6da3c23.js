(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e0e199e"],{"333d":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},r=[];a("c5f6");Math.easeInOutQuad=function(e,t,a,l){return e/=l/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function n(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,a){var l=o(),r=e-l,s=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=s;var o=Math.easeInOutQuad(c,l,r,t);n(o),c<t?i(e):a&&"function"===typeof a&&a()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&s(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&s(0,800)}}},u=c,d=(a("9567"),a("2877")),m=Object(d["a"])(u,l,r,!1,null,"2fa86365",null);t["a"]=m.exports},3816:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"g",(function(){return i})),a.d(t,"f",(function(){return n})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"a",(function(){return m})),a.d(t,"j",(function(){return p}));var l=a("b775");function r(e){return Object(l["a"])({url:"/api/PatrolFile/getPatrolFileList",method:"post",data:e})}function i(e){return Object(l["a"])({url:"/api/PatrolRecord/getPatrolRecordList",method:"post",data:e})}function n(e){return Object(l["a"])({url:"/api/AlarmRecord/getCurrentAlarmRecordList",method:"post",data:e})}function o(){return Object(l["a"])({url:"/api/AlarmRecord/getAlarmStateList",method:"get"})}function s(e){return Object(l["a"])({url:"/api/AlarmRecord/getAlarmRecordList",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/api/AlarmRecord/dealAlarm",method:"post",data:e})}function u(e){return Object(l["a"])({url:"/api/AlarmRecord/getAlarmDealLog",method:"post",params:e})}function d(){return Object(l["a"])({url:"/api/PatrolTask/GetRealPatrolTaskList",method:"get"})}function m(e){return Object(l["a"])({url:"/api/PatrolTask/CancelPatrolTask",method:"post",data:e})}function p(){return Object(l["a"])({url:"/api/PatrolRecord/getPatrolActionTypeList",method:"get"})}},"89b6":function(e,t,a){},9567:function(e,t,a){"use strict";a("c54f")},c54f:function(e,t,a){},d458:function(e,t,a){"use strict";a("89b6")},f80e:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"1%"}},[a("div",{staticClass:"equip-header content-header"},[a("el-select",{attrs:{clearable:"",size:"mini",placeholder:"请选择告警状态"},model:{value:e.alarmState,callback:function(t){e.alarmState=t},expression:"alarmState"}},e._l(e.alarmStateOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),a("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.init()}}},[e._v(e._s(e.$t("public_vary.query_label")))])],1),e._v(" "),a("div",{staticClass:"equip-body content-body"},[a("el-table",{staticClass:"equip-data",attrs:{data:e.alarmInfoArr,"header-row-class-name":"header-row-class","row-class-name":"row-class",fit:"","highlight-current-row":"",size:"small"},on:{"row-click":e.getDetailMessage}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"alarmCode",label:e.$t("alarm_dealWith.alarm_code_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.alarmCode))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"alarmName",label:e.$t("alarm_dealWith.alarm_name_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.alarmName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"alarmStatus",label:e.$t("alarm_dealWith.alarm_status_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.alarmStatus))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"maxAlarmLevel",label:e.$t("alarm_dealWith.maxAlarm_level_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.maxAlarmLevel))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"maxAlarmValue",label:e.$t("alarm_dealWith.maxAlarm_value_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.maxAlarmValue))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"equipmentName",label:e.$t("alarm_dealWith.equipment_name_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.equipmentName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"happenTime",label:e.$t("alarm_dealWith.happen_time"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.happenTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dealWithTime",label:e.$t("alarm_dealWith.dealWith_time"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.dealWithTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"details",label:"操作",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"primary",icon:"el-icon-document",size:"mini",plain:""},on:{click:function(t){return e.showDetail(l)}}},[e._v(e._s(e.$t("public_vary.details_label")))])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"告警详情",visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticStyle:{display:"flex"}},[a("img",{staticStyle:{width:"70%"},attrs:{src:e.imageUrl,alt:""}}),e._v(" "),a("div",{staticStyle:{"margin-left":"2vw"}},[a("div",{staticStyle:{margin:"1vh  0"}},[e._v("警告级别: \n            "),4==e.alarm.maxAlarmLevel?a("span",{staticStyle:{border:"red 1px solid",color:"red","font-size":"1.2vw"}},[e._v("致命")]):e._e(),e._v(" "),3==e.alarm.maxAlarmLevel?a("span",{staticStyle:{border:"red 1px solid",color:"orange","font-size":"1.2vw"}},[e._v("严重")]):e._e(),e._v(" "),2==e.alarm.maxAlarmLevel?a("span",{staticStyle:{border:"red 1px solid",color:"yellow","font-size":"1vw"}},[e._v("一般")]):e._e(),e._v(" "),1==e.alarm.maxAlarmLevel?a("span",{staticStyle:{border:"red 1px solid",color:"#08F9EB","font-size":"1vw"}},[e._v("提示")]):e._e()]),e._v(" "),a("div",{staticStyle:{margin:"2vh  0"}},[e._v("\n            告警名称："+e._s(e.alarm.alarmName)+"\n          ")]),e._v(" "),a("div",{staticStyle:{margin:"3vh  0"}},[e._v("\n            告警编号："+e._s(e.alarm.id)+"\n          ")]),e._v(" "),a("div",{staticStyle:{margin:"3vh  0"}},[e._v("\n            告警类型："+e._s(1001==e.alarm.alarmCode?"行人警告":1002==e.alarm.alarmCode?"非机动车告警":1003==e.alarm.alarmCode?"异物警告":1004==e.alarm.alarmCode?"温度警告":1005==e.alarm.alarmCode?"湿度警告":1006==e.alarm.alarmCode?"气体警告":1007==e.alarm.alarmCode?"灯光警告":"其他警告")+"\n          ")]),e._v(" "),a("div",{staticStyle:{margin:"3vh 0"}},[e._v("\n            事件描述："+e._s(e.alarm.Description)+"\n          ")]),e._v(" "),a("div",{staticStyle:{margin:"3vh 0"}},[e._v("\n            告警位置："+e._s(e.alarm.X)+","+e._s(e.alarm.Y)+"\n          ")]),e._v(" "),a("div",{staticStyle:{margin:"3vh  0"}},[e._v("\n            发生时间："+e._s(e.alarm.happenTime)+"\n          ")]),e._v(" "),a("div",{staticStyle:{margin:"3vh  0"}},[e._v("\n            修复时间："+e._s(null==e.alarm.RecoveryTime?"未修复":e.alarm.RecoveryTime)+"\n          ")])])]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)]),e._v(" "),a("div",[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.page,limit:e.limit},on:{"update:page":function(t){e.page=t},"update:limit":function(t){e.limit=t},pagination:e.init}})],1)],1),e._v(" "),a("el-dialog",{staticClass:"dialog-class",attrs:{title:e.$t("alarm_dealWith.alarm_details_label"),"visible.sync":"false"}},[a("div",[a("el-descriptions",{attrs:{title:"告警详情",column:2}},[a("el-descriptions-item",{attrs:{label:"告警码"}},[e._v(e._s(e.detailsList.alarmCode))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"告警名称"}},[e._v(e._s(e.detailsList.alarmName))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"告警状态"}},[e._v(e._s(e.detailsList.alarmStatus))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"设备名称"}},[e._v(e._s(e.detailsList.equipmentName))])],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("文件")]),e._v(" "),a("swiper",{ref:"mySwiper",attrs:{options:e.swiperOptions}},e._l(e.detailes,(function(e){return a("swiper-slide",{key:e.url,staticClass:"info-item"},[2===e.type?[a("video",{staticClass:"centeredVideo",attrs:{id:"detailVideo",controls:"",autoplay:"",width:"300",height:"240"}},[a("source",{attrs:{src:e.url,type:"video/mp4"}})])]:[a("el-image",{staticStyle:{width:"300px",height:"240px"},attrs:{src:e.url,lazy:""}})]],2)})),1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("日志")]),e._v(" "),a("el-table",{staticClass:"detail-data",attrs:{data:e.detailsLog,"header-row-class-name":"header-row-class","highlight-current-row":!1,size:"small","max-height":"380px"}},[a("el-table-column",{attrs:{prop:"alarmCode",label:e.$t("alarm_dealWith.alarm_code_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.alarmCode))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dealWithPe",label:e.$t("alarm_dealWith.dealWith_people_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.dealWithPe))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dealWithWay",label:e.$t("alarm_dealWith.dealWith_way_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(0===l.dealWithWay?"手动处理":"自动恢复"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dealWithResults",label:e.$t("alarm_dealWith.dealWith_results_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.dealWithResults))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dealWithDescribe",label:e.$t("alarm_dealWith.dealWith_describe_label"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.dealWithDescribe))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"dealWithTime",label:e.$t("alarm_dealWith.dealWith_time"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("span",[e._v(e._s(l.dealWithTime))])]}}])})],1)],1)])],1)},r=[],i=(a("ac6a"),a("c7eb")),n=(a("96cf"),a("1da1")),o=a("ade3"),s=(a("7514"),a("3816")),c=a("333d"),u=(a("2f62"),{components:{Pagination:c["a"]},data:function(){return{activeName:"1",alarmState:"",alarmStateOptions:[],refreshTimer:null,alarmInfoArr:[],dialogDetailFlag:!1,detailsLog:[],carAlarmFlag:!1,inspectAlarmFlag:!1,total:0,page:1,limit:10,detailsList:"",detailes:[],imageUrl:null,alarm:[],dialogVisible:!1,swiperOptions:{slidesPerView:"auto"}}},mounted:function(){this.initAlarmState()},beforeDestroy:function(){clearTimeout(this.refreshTimer),this.refreshTimer=null},methods:{init:function(){var e=this,t={current:e.page,limit:e.limit,status:e.alarmState};Object(s["d"])(t).then((function(t){e.total=t.data.total;for(var a=t.data.records,l=[],r=function(t,r){var i,n=e.alarmStateOptions.find((function(e){return e.value===a[t].Status})).label,s=(i={id:a[t].ID,alarmCode:a[t].AlarmCode,alarmName:a[t].AlarmName,maxAlarmLevel:a[t].MaxLevel,maxAlarmValue:a[t].HighValue},Object(o["a"])(i,"alarmCode",a[t].AlarmCode),Object(o["a"])(i,"machineName",a[t].CarrierName),Object(o["a"])(i,"equipmentName",a[t].CarrierName),Object(o["a"])(i,"alarmStatus",n),Object(o["a"])(i,"statusNum",a[t].Status),Object(o["a"])(i,"X",a[t].X),Object(o["a"])(i,"Y",a[t].Y),Object(o["a"])(i,"happenTime",a[t].ReportTime),Object(o["a"])(i,"RecoveryTime",a[t].RecoveryTime),Object(o["a"])(i,"Description",a[t].Description),Object(o["a"])(i,"Image",a[t].Image),Object(o["a"])(i,"patrolRecordID",a[t].PatrolRecordID),Object(o["a"])(i,"vertexNumber",a[t].VertexNumber),Object(o["a"])(i,"locationID",a[t].LocationID),Object(o["a"])(i,"edgeNumber",a[t].EdgeNumber),Object(o["a"])(i,"alarmType",a[t].AlarmType),i);l.push(s)},i=0,n=a.length;i<n;i++)r(i,n);e.alarmInfoArr=l})).catch((function(t){e.$notify({title:e.$t("user.Failure"),message:e.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))},getDetailMessage:function(){var e=Object(n["a"])(Object(i["a"])().mark((function e(t){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("实时",t),this.alarm=t,this.imageUrl=t.Image,this.dialogVisible=!0;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),initAlarmState:function(){var e=this,t=this;Object(s["e"])().then((function(a){a&&a.data.length&&(t.alarmStateOptions=[],a.data.forEach((function(e){var a={value:e.Code,label:e.Desc};t.alarmStateOptions.push(a)})),e.init())})).catch((function(){}))},showDetail:function(e){var t=this;console.log("查看详情数据",e);var a=this;this.dialogDetailFlag=!0,this.detailsList=e,Object(s["c"])({alarmRecordID:e.id}).then((function(e){for(var t=e.data,l=[],r=0,i=t.length;r<i;r++){var n={id:t[r].id,alarmCode:t[r].alarmCode,dealWithPe:t[r].dealPerson,dealWithWay:t[r].dealType,dealWithResults:t[r].dealResult,dealWithDescribe:t[r].description,dealWithTime:t[r].dealTime};l.push(n)}a.detailsLog=l})).catch((function(e){a.$notify({title:a.$t("user.Failure"),message:a.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})})),Object(s["h"])({alarmRecordID:e.id}).then(function(){var e=Object(n["a"])(Object(i["a"])().mark((function e(a){var l,r,n,o;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:l=a.data,t.videoUrl="",r=Object(i["a"])().mark((function e(a,r){var n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1!=l[a].FileType){e.next=5;break}n="/api/PatrolFile/GetPhotoData?fileID="+l[a].ID,t.detailes.push({url:n,type:1}),e.next=8;break;case 5:if(4!=l[a].FileType){e.next=8;break}return e.next=8,t.$nextTick((function(){t.videoUrl="/api/PatrolFile/GetVideoData?fileID="+l[a].ID,t.detailes.push({url:t.videoUrl,type:2})}));case 8:case"end":return e.stop()}}),e)})),n=0,o=l.length;case 4:if(!(n<o)){e.next=9;break}return e.delegateYield(r(n,o),"t0",6);case 6:n++,e.next=4;break;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){a.$notify({title:a.$t("user.Failure"),message:a.$t("user.interface_call_failed_tip"),type:"error",duration:1e3})}))}}}),d=u,m=(a("d458"),a("2877")),p=Object(m["a"])(d,l,r,!1,null,"d0b809f4",null);t["default"]=p.exports}}]);